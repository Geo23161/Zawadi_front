{"version":3,"file":"js/478.a2455a12.js","mappings":"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","sources":["webpack://Zawadi/./src/global/seller_auth.ts","webpack://Zawadi/./src/views/PayView.vue","webpack://Zawadi/./src/views/PayView.vue?57d5"],"sourcesContent":["import { Storage } from \"@ionic/storage\"\nimport { alertController, loadingController, toastController } from \"@ionic/vue\";\nimport axios from \"axios\";\nimport { Router } from \"vue-router\";\n\nexport const check_connect = async () => {\n    const storage = new Storage({\n        name: \"seller_info\",\n    });\n    storage.create()\n    const token: string | undefined = await storage.get('stoken')\n    if (!token) return false\n    else {\n        const json_tok = JSON.parse(token)\n        try {\n            const resp = await axios({\n                url: 'v2/ping',\n                method: 'GET',\n                headers: {\n                    Authorization: `Bearer ${json_tok.access}`\n                },\n            })\n            if (resp.data['done']) return true\n        } catch (err: any) {\n            if (err.response.status == 401) {\n                const form = new FormData()\n                form.append('refresh', json_tok.refresh)\n                try {\n                    const refresh_res = await axios({\n                        url: 'api/token/refresh/',\n                        method: 'POST',\n                        data: form\n                    })\n                    json_tok.access = refresh_res.data['access']\n                    storage.set('stoken', JSON.stringify(json_tok))\n                    return true\n                } catch (err: any) {\n                    if (err.response.status == 401) return false\n                }\n            }\n        }\n    }\n}\n\nexport const showLoading = async (mess: string) => {\n    const loading = await loadingController.create({\n        message: mess,\n    });\n    loading.present();\n    return loading\n};\n\nexport const show_alert = async (title: string, mess: string) => {\n    const alert = await alertController.create({\n        header: title,\n        message: mess,\n        buttons: [\"OK\"],\n    });\n\n    await alert.present();\n};\n\nexport const show_warn = async (title: string, mess: string, but1: string, handler1: () => Promise<void>) => {\n    const alert = await alertController.create({\n        header: title,\n        message: mess,\n        buttons: [\n            {\n                text: 'Fermer',\n                role: 'cancel'\n            },\n            {\n                text: but1,\n                role: 'confirm',\n                handler: () => {\n                    handler1()\n                },\n            },\n        ],\n    });\n\n    await alert.present();\n};\n\nexport const presentToast = async (position: 'top' | 'middle' | 'bottom', text: string, color = 'primary') => {\n    const toast = await toastController.create({\n        mode : 'ios',\n        message: text,\n        position: position,\n        duration: 3900,\n        color : color,\n    });\n\n    await toast.present();\n}\n\nexport const access_tok = async (path: string, router: Router, load : HTMLIonLoadingElement|undefined) => {\n    const storage = new Storage({\n        name: \"seller_info\",\n    });\n    storage.create();\n    const token: string | undefined = await storage.get('stoken')\n    if (!token){\n        if (load) load.dismiss();\n        return router.push(`/seller?redirect=${path}`)\n    } \n    else {\n        const json_tok = JSON.parse(token)\n        try {\n            const resp = await axios({\n                url: 'v2/ping',\n                method: 'GET',\n                headers: {\n                    Authorization: `Bearer ${json_tok.access}`\n                },\n            })\n            return json_tok.access as string\n        } catch (err: any) {\n            if (err.response.status == 401) {\n                const form = new FormData()\n                form.append('refresh', json_tok.refresh)\n                try {\n                    const refresh_res = await axios({\n                        url: 'api/token/refresh/',\n                        method: 'POST',\n                        data: form\n                    })\n                    json_tok.access = refresh_res.data['access']\n                    storage.set('stoken', JSON.stringify(json_tok))\n                    return refresh_res.data['access'] as string\n                } catch (err: any) {\n                    if (err.response.status == 401) return router.push(`/seller?redirect=${path}`)\n                }\n            }\n        }\n    }\n}\n\nexport const call_num = (num : string) => {\n    window.location.href = 'tel:' + num;\n}\n\n\n","<template>\n  <ion-page>\n    <ion-header>\n      <ion-toolbar color=\"secondary\">\n        <ion-buttons slot=\"start\">\n          <ion-back-button default-href=\"/seller\"></ion-back-button>\n        </ion-buttons>\n        <ion-title>Activité de paiement</ion-title>\n      </ion-toolbar>\n    </ion-header>\n    <ion-content v-if=\"has_load\">\n      <div class=\"ban\">\n        <div class=\"myico yellow_bg\">\n          <ion-icon :icon=\"cash\" />\n        </div>\n        <div class=\"ban_cont\">\n          <div class=\"title_b\">Solde total</div>\n          <div class=\"contentb\">XOF{{ spays.total_solde }}</div>\n        </div>\n      </div>\n      <div class=\"ban\">\n        <div class=\"myico green_bg\">\n          <ion-icon :icon=\"cash\" />\n        </div>\n        <div class=\"ban_cont\">\n          <div class=\"title_b\">Solde disponible</div>\n          <div class=\"contentb\">XOF{{ spays.solde }}</div>\n        </div>\n      </div>\n      <div class=\"ban\">\n        <div class=\"myico orange_bg\">\n          <ion-icon :icon=\"people\" />\n        </div>\n        <div class=\"ban_cont\">\n          <div class=\"title_b\">Produits vendus</div>\n          <div class=\"contentb\">{{ spays.p_count }}</div>\n        </div>\n      </div>\n      <div style=\"padding-left: 1rem; padding-right: 1rem\">\n        <ion-button @click=\"encaisser()\" color=\"secondary\" expand=\"full\"\n          >Encaisser</ion-button\n        >\n      </div>\n\n      <div class=\"mytitle\">Historiques des paiements</div>\n      <ion-list v-if=\"spays.pays.length\">\n        <ion-item v-for=\"pay in spays.pays\" :key=\"pay.id\">\n          <ion-label>\n            <h2>\n              <span style=\"font-weight: bold\">Montant: </span>{{ pay.currency\n              }}{{ pay.montant }}\n            </h2>\n            <div>\n              <div>\n                Type :\n                <span :style=\"{ color: pay.get_tcolor }\">{{\n                  pay.type_of\n                }}</span>\n              </div>\n              <div>\n                Etat :\n                <span :style=\"{ color: pay.get_color }\">{{ pay.statut }}</span>\n              </div>\n              <div>\n                Reference ID : <span>{{ pay.transaction_id }}</span>\n              </div>\n              <div style=\"color: gray\">\n                {{ get_date(pay.created_at) }}\n              </div>\n            </div>\n          </ion-label>\n          <ion-button\n            @click=\"call_num(spays.call_num)\"\n            color=\"tertiary\"\n            slot=\"end\"\n          >\n            <ion-icon slot=\"icon-only\" :icon=\"call\"></ion-icon>\n          </ion-button>\n        </ion-item>\n      </ion-list>\n      <ion-list v-else>\n        <div\n          style=\"display: flex; justify-content: space-around; padding: 2rem\"\n        >\n          <img src=\"../../public/assets/img/retrait.svg\" style=\"width: 60%\" />\n        </div>\n        <div\n          style=\"\n            text-align: center;\n            padding-left: 1.5rem;\n            padding-right: 1.5rem;\n          \"\n        >\n          Aucune transactions trouvé.\n        </div>\n      </ion-list>\n    </ion-content>\n    <ion-content v-else>\n      <div style=\"min-height: 95vh\"></div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<style scoped>\n.mytitle {\n  padding: 1rem;\n  text-align: center;\n  font-size: 1.2rem;\n  font-weight: 600;\n}\n\n.bg {\n  background: rgb(235, 233, 233);\n  min-height: 100vh;\n}\n\n.contentb {\n  font-size: 1.3rem;\n  font-weight: 700;\n}\n\n.title_b {\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: #575757;\n  padding-bottom: 0.2rem;\n}\n\n.yellow_bg {\n  background: rgba(234, 0, 255, 0.261);\n  color: rgb(234, 0, 255);\n}\n\n.orange_bg {\n  background: rgba(255, 166, 0, 0.219);\n  color: orange;\n}\n\n.green_bg {\n  background: rgba(0, 128, 0, 0.213);\n  color: green;\n}\n\n.myico {\n  margin-right: 0.9rem;\n  border-radius: 100%;\n  padding-bottom: 0.5rem;\n  padding-left: 0.7rem;\n  padding-right: 0.7rem;\n  padding-top: 0.7rem;\n}\n\n.ban {\n  margin-left: 1rem;\n  margin-right: 1rem;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n  padding: 1rem;\n  display: flex;\n  align-items: center;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n  border-radius: 15px;\n  background: rgb(243, 242, 242);\n}\n</style>\n\n<script setup >\nimport {\n  IonPage,\n  IonContent,\n  IonHeader,\n  IonToolbar,\n  IonButtons,\n  IonBackButton,\n  IonTitle,\n  IonLabel,\n  IonItem,\n  IonButton,\n  onIonViewDidEnter,\n} from \"@ionic/vue\";\nimport { ref } from \"vue\";\nimport { cash, people, call } from \"ionicons/icons\";\nimport {\n  access_tok,\n  showLoading,\n  show_alert,\n  call_num,\n} from \"@/global/seller_auth\";\nimport axios from \"axios\";\nimport { useRouter } from \"vue-router\";\nconst get_date = (utc) => {\n  const date = new Date(utc);\n  return date.toLocaleDateString() + \" \" + date.toLocaleTimeString();\n};\nconst has_load = ref(false);\nconst spays = ref();\nconst router = useRouter();\nconst get_spays = async () => {\n  const load = await showLoading(\"Loading...\");\n  const resp = await axios.get(\"v2/api/get_spays/\", {\n    headers: {\n      Authorization: `Bearer ${await access_tok(\"/seller/pay/\", router)}`,\n    },\n  });\n  if (resp.data[\"done\"]) {\n    spays.value = resp.data[\"result\"];\n    has_load.value = true;\n    load.dismiss();\n  }\n};\nget_spays();\nconst encaisser = async () => {\n  if (!spays.value.solde)\n    return show_alert(\"Retrait impossible\", \"Votre solde est insuffisant.\");\n  if (spays.value.has_retr)\n    return show_alert(\n      \"Retrait impossible\",\n      \"Vous avez déjà un retrait en cours.\"\n    );\n  const load = await showLoading(\"Loading...\");\n  const resp = await axios.get(\"v2/api/encaisser/\", {\n    headers: {\n      Authorization: `Bearer ${await access_tok(\"/seller/pay/\", router)}`,\n    },\n  });\n  if (resp.data[\"done\"]) {\n    load.dismiss();\n    await get_spays();\n  }\n};\n</script>  \n","import script from \"./PayView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PayView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PayView.vue?vue&type=style&index=0&id=42512504&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/georis/Bureau/multi/GambleProjs/Final_Zawadi/Zawadi/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-42512504\"]])\n\nexport default __exports__"],"names":["check_connect","async","storage","Storage","name","create","token","get","json_tok","JSON","parse","resp","axios","url","method","headers","Authorization","access","data","err","response","status","form","FormData","append","refresh","refresh_res","set","stringify","showLoading","loading","loadingController","message","mess","present","show_alert","title","alert","alertController","header","buttons","show_warn","but1","handler1","text","role","handler","presentToast","position","color","toast","toastController","mode","duration","access_tok","path","router","load","dismiss","push","call_num","num","window","location","href","get_date","utc","date","Date","toLocaleDateString","toLocaleTimeString","has_load","ref","spays","useRouter","get_spays","value","encaisser","solde","has_retr","__exports__"],"sourceRoot":""}